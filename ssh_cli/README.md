# SSH File Browser

SSH経由でリモートサーバーのファイルをブラウズ・管理するためのGUIアプリケーション（Rust製）

![License](https://img.shields.io/badge/license-MIT-blue.svg)
![Rust](https://img.shields.io/badge/rust-1.70%2B-orange.svg)

## 特徴

- 🔐 **セキュアなSSH接続**: SFTP APIを使用した安全なファイル操作
- 📁 **ファイルブラウジング**: リモートディレクトリの閲覧とナビゲーション
- 🔍 **ファイル検索**: 再帰的検索対応のパターンマッチング
- 📥 **ファイルダウンロード**: SCPによる高速ダウンロード
- 👁️ **ファイルプレビュー**: UTF-8/Shift-JIS対応のテキストビューア
- ⭐ **お気に入り接続**: 接続情報の保存・管理
- 🗂️ **ソート機能**: 名前・サイズ・日付でソート
- 🇯🇵 **日本語対応**: MS Gothic/Meiryoフォント自動読み込み

## スクリーンショット

### ログイン画面
お気に入り接続の選択、SSH接続情報の入力

### ファイルブラウザ
ディレクトリナビゲーション、検索、ソート機能

### ファイルビューア
エンコーディング選択可能なテキストプレビュー

## インストール

### 前提条件

- Rust 1.70以上
- Windows 10/11 (他のOSでも動作可能)

### ビルド

```bash
cargo build --release
```

### 実行

```bash
cargo run --release
```

または、ビルドされた実行ファイルを直接実行：

```bash
.\target\release\ssh_cli.exe
```

## 使い方

### 1. SSH接続

1. ホストを入力
2. ユーザー名とパスワードを入力
3. 「Connect」ボタンをクリック

### 2. お気に入り接続

- **保存**: 接続情報を入力後、名前を入力して「Save as Favorite」
- **使用**: ドロップダウンから選択すると自動入力
- **削除**: 名前を選択して「Delete Favorite」

### 3. ファイル操作

#### ディレクトリナビゲーション
- ファイル名をダブルクリックでディレクトリに移動
- 「⬆」ボタンで親ディレクトリへ
- アドレスバーに直接パスを入力して「Go」

#### ファイル検索
- 検索ボックスにパターンを入力（例: `*.txt`, `file.?s`）
- 「Recursive」チェックでサブディレクトリも検索
- 「Search」ボタンまたはEnterキーで実行

#### ファイルダウンロード
1. ファイルを選択
2. 「Download」ボタンをクリック
3. 保存先を選択

#### ファイルプレビュー
1. ファイルを選択
2. 「View」ボタンをクリック
3. エンコーディングドロップダウンでUTF-8/Shift-JISを選択

#### ソート
- テーブルヘッダー（Permission, Size, Date, Name）をクリック
- 再度クリックで昇順/降順切り替え

## 技術仕様

### アーキテクチャ

- **GUI**: eframe/egui
- **SSH/SFTP**: ssh2クレート
- **エンコーディング**: encoding_rs
- **設定保存**: serde/serde_json

### セキュリティ

✅ **コマンドインジェクション対策完了**
- SFTP APIを使用し、シェルコマンド実行を完全に排除
- パス検証はSFTP APIレベルで自動実行
- エスケープ処理不要

⚠️ **パスワード保存**
- お気に入り機能はパスワードを平文で`favorites.json`に保存
- 本番環境では暗号化または除外を推奨

### 依存関係

```toml
[dependencies]
eframe = "0.29"
egui = "0.29"
egui_extras = "0.29"
ssh2 = "0.9"
anyhow = "1.0"
rfd = "0.15"
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"
encoding_rs = "0.8"
chrono = "0.4"
regex = "1.0"
```

## プロジェクト構成

```
src/
├── main.rs          # エントリポイント
├── app.rs           # UI & アプリケーションロジック
├── ssh.rs           # SFTP操作
└── model.rs         # データ構造
```

## 設定ファイル

### favorites.json

お気に入り接続情報を保存（自動生成）

```json
[
  {
    "name": "開発サーバー",
    "host": "10.0.0.0",
    "user": "user",
    "password": "password123"
  }
]
```

**場所**: 実行ファイルと同じディレクトリ

## トラブルシューティング

### 日本語が文字化けする

- MS GothicまたはMeiryoフォントがインストールされているか確認
- フォントパス: `C:\Windows\Fonts\msgothic.ttc` または `meiryo.ttc`

### 接続できない

- ホスト名とポート番号が正しいか確認
- SSHサーバーが起動しているか確認
- ファイアウォール設定を確認

### ファイルが表示されない

- パーミッションを確認
- パスが正しいか確認

## 開発

### テスト実行

```bash
cargo test
```

### コードフォーマット

```bash
cargo fmt
```

### Lintチェック

```bash
cargo clippy
```

## ライセンス

MIT License

## 作者

開発: Antigravity (Google Deepmind)

## 変更履歴

### v2.0.0 (2026-02-08)
- SFTP APIへの移行
- コマンドインジェクション対策完了
- セキュリティ強化

### v1.0.0
- 初回リリース
- 基本的なファイルブラウジング機能
- お気に入り接続機能
- ファイルプレビュー機能

## 今後の予定

- [ ] ファイルアップロード機能
- [ ] ファイル編集機能
- [ ] 複数接続のタブ管理
- [ ] キーボードショートカット
- [ ] ブックマーク機能
- [ ] ファイル権限の変更
- [ ] シンボリックリンク対応
